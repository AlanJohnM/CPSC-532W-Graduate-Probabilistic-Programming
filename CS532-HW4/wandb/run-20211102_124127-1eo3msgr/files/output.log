
  0%|                                                                                       | 0/100000 [00:00<?, ?it/s]

  0%|                                                           | 1/100000 [00:04<138:24:11,  4.98s/it, ELBO=-8.34e+04]

  0%|                                                           | 2/100000 [00:09<131:57:55,  4.75s/it, ELBO=-7.63e+03]

  0%|                                                           | 3/100000 [00:13<129:24:19,  4.66s/it, ELBO=-1.52e+03]

  0%|                                                                | 4/100000 [00:17<125:46:34,  4.53s/it, ELBO=-125]

  0%|                                                               | 5/100000 [00:22<123:47:46,  4.46s/it, ELBO=-49.6]

  0%|                                                               | 6/100000 [00:26<123:39:09,  4.45s/it, ELBO=-65.8]

  0%|                                                               | 7/100000 [00:30<121:20:45,  4.37s/it, ELBO=-74.8]

  0%|                                                               | 8/100000 [00:35<121:24:00,  4.37s/it, ELBO=-87.7]

  0%|                                                                | 9/100000 [00:39<121:39:09,  4.38s/it, ELBO=-106]

  0%|                                                               | 10/100000 [00:43<120:13:46,  4.33s/it, ELBO=-119]

  0%|                                                               | 11/100000 [00:48<121:04:52,  4.36s/it, ELBO=-137]

  0%|                                                               | 12/100000 [00:52<118:59:17,  4.28s/it, ELBO=-151]

  0%|                                                               | 13/100000 [00:56<119:15:00,  4.29s/it, ELBO=-164]

  0%|                                                               | 14/100000 [01:01<120:24:34,  4.34s/it, ELBO=-369]

  0%|                                                               | 15/100000 [01:05<119:23:08,  4.30s/it, ELBO=-387]

  0%|                                                               | 16/100000 [01:09<123:04:21,  4.43s/it, ELBO=-408]

  0%|                                                               | 17/100000 [01:14<122:28:13,  4.41s/it, ELBO=-424]

  0%|                                                               | 18/100000 [01:18<121:44:04,  4.38s/it, ELBO=-438]

  0%|                                                               | 19/100000 [01:23<123:29:14,  4.45s/it, ELBO=-455]

  0%|                                                               | 20/100000 [01:27<122:58:01,  4.43s/it, ELBO=-476]

  0%|                                                               | 21/100000 [01:32<123:29:54,  4.45s/it, ELBO=-493]

  0%|                                                               | 22/100000 [01:36<122:16:34,  4.40s/it, ELBO=-506]

  0%|                                                               | 23/100000 [01:41<127:48:04,  4.60s/it, ELBO=-516]

  0%|                                                               | 24/100000 [01:46<127:42:07,  4.60s/it, ELBO=-525]

  0%|                                                               | 25/100000 [01:50<125:48:33,  4.53s/it, ELBO=-530]

  0%|                                                               | 26/100000 [01:54<123:58:48,  4.46s/it, ELBO=-531]

  0%|                                                               | 27/100000 [01:58<117:40:36,  4.24s/it, ELBO=-547]


  0%|                                                               | 29/100000 [02:06<111:24:47,  4.01s/it, ELBO=-559]

  0%|                                                               | 30/100000 [02:09<108:17:23,  3.90s/it, ELBO=-558]
-557.9373168945312

  0%|                                                               | 31/100000 [02:13<106:22:17,  3.83s/it, ELBO=-566]

  0%|                                                               | 32/100000 [02:17<107:27:49,  3.87s/it, ELBO=-570]

  0%|                                                               | 33/100000 [02:21<105:57:20,  3.82s/it, ELBO=-588]

  0%|                                                               | 34/100000 [02:24<104:32:37,  3.76s/it, ELBO=-583]

  0%|                                                               | 35/100000 [02:28<103:51:33,  3.74s/it, ELBO=-591]

  0%|                                                               | 36/100000 [02:32<105:22:26,  3.79s/it, ELBO=-590]

  0%|                                                               | 37/100000 [02:36<104:24:55,  3.76s/it, ELBO=-588]

  0%|                                                               | 38/100000 [02:39<103:54:26,  3.74s/it, ELBO=-583]

  0%|                                                               | 39/100000 [02:43<103:34:12,  3.73s/it, ELBO=-592]

  0%|                                                               | 40/100000 [02:47<102:48:43,  3.70s/it, ELBO=-591]

  0%|                                                               | 41/100000 [02:50<104:49:02,  3.77s/it, ELBO=-580]

  0%|                                                               | 42/100000 [02:54<103:47:45,  3.74s/it, ELBO=-587]

  0%|                                                               | 43/100000 [02:58<103:43:15,  3.74s/it, ELBO=-588]

  0%|                                                               | 44/100000 [03:02<103:02:46,  3.71s/it, ELBO=-584]

  0%|                                                               | 45/100000 [03:05<102:37:19,  3.70s/it, ELBO=-587]

  0%|                                                               | 46/100000 [03:09<105:04:10,  3.78s/it, ELBO=-586]

  0%|                                                               | 47/100000 [03:13<104:30:09,  3.76s/it, ELBO=-578]


  0%|                                                               | 49/100000 [03:20<103:34:45,  3.73s/it, ELBO=-573]
-572.5137329101562

  0%|                                                               | 50/100000 [03:24<106:07:43,  3.82s/it, ELBO=-565]

  0%|                                                               | 51/100000 [03:28<106:31:30,  3.84s/it, ELBO=-556]Traceback (most recent call last):
  File "inference.py", line 372, in <module>
    samples = inference_algorithm(program, args.n_samples)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 161, in black_box_variational_inference
    log_W_t[l], G_t[l] = sigma['log_W'], sigma['G']
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 36, in evaluate_program
    return EVAL(ast[0], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 79, in EVAL
    c_1, sigma = EVAL(e[1][1], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 93, in EVAL
    c[i], sigma = EVAL(e[i], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 98, in EVAL
    return c[0](*c[1:]), sigma
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/distributions.py", line 14, in __init__
    super().__init__(loc, torch.nn.functional.softplus(self.optim_scale))
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/distributions/normal.py", line 50, in __init__
    super(Normal, self).__init__(batch_shape, validate_args=validate_args)
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/distributions/distribution.py", line 62, in __init__
    if not constraint.check(getattr(self, param)).all():
KeyboardInterrupt