























































































































































































































































 46%|██████████████████████████████████████████████▋                                                       | 4576/10000 [08:26<14:19,  6.31it/s, ELBO=-8.68]Traceback (most recent call last):
  File "inference.py", line 372, in <module>
    samples = inference_algorithm(program, args.n_samples)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 160, in black_box_variational_inference
    r_tl, sigma_tl = evaluate_program(ast,sigma=sigma)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 36, in evaluate_program
    return EVAL(ast[0], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  [Previous line repeated 1 more time]
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 79, in EVAL
    c_1, sigma = EVAL(e[1][1], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 75, in EVAL
    sigma['log_W'] = sigma['log_W'] + d.log_prob(c).detach()
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/distributions.py", line 33, in log_prob
    return super().log_prob(x)
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/distributions/normal.py", line 73, in log_prob
    self._validate_sample(value)
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/distributions/distribution.py", line 274, in _validate_sample
    for i, j in zip(reversed(actual_shape), reversed(expected_shape)):
KeyboardInterrupt