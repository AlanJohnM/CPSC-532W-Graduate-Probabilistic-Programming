
  0%|                                                                                       | 0/100000 [00:00<?, ?it/s]

  0%|                                                            | 1/100000 [00:07<213:13:13,  7.68s/it, ELBO=-6.6e+05]


  0%|                                                           | 3/100000 [00:21<204:07:36,  7.35s/it, ELBO=-4.76e+04]

  0%|                                                           | 4/100000 [00:29<207:33:30,  7.47s/it, ELBO=-6.07e+04]

  0%|                                                           | 5/100000 [00:38<223:23:47,  8.04s/it, ELBO=-2.01e+04]

  0%|                                                           | 6/100000 [00:47<226:53:55,  8.17s/it, ELBO=-2.13e+05]

  0%|                                                           | 7/100000 [00:54<219:30:24,  7.90s/it, ELBO=-1.69e+04]

  0%|                                                           | 8/100000 [01:01<212:57:23,  7.67s/it, ELBO=-5.24e+06]

  0%|                                                           | 9/100000 [01:08<207:18:05,  7.46s/it, ELBO=-4.74e+04]

  0%|                                                          | 10/100000 [01:15<203:55:55,  7.34s/it, ELBO=-4.76e+03]

  0%|                                                          | 11/100000 [01:22<202:09:08,  7.28s/it, ELBO=-3.84e+03]

  0%|                                                           | 12/100000 [01:30<200:29:21,  7.22s/it, ELBO=-2.8e+03]

  0%|                                                          | 13/100000 [01:37<202:05:30,  7.28s/it, ELBO=-3.63e+03]

  0%|                                                          | 14/100000 [01:44<197:45:43,  7.12s/it, ELBO=-2.02e+03]
-2021.228759765625

  0%|                                                          | 15/100000 [01:51<195:34:35,  7.04s/it, ELBO=-5.44e+03]

  0%|                                                          | 16/100000 [01:57<191:34:32,  6.90s/it, ELBO=-1.82e+04]

  0%|                                                               | 17/100000 [02:04<192:16:50,  6.92s/it, ELBO=-648]

  0%|                                                          | 18/100000 [02:11<189:50:35,  6.84s/it, ELBO=-3.11e+03]

  0%|                                                          | 19/100000 [02:18<191:07:33,  6.88s/it, ELBO=-9.08e+03]

  0%|                                                          | 20/100000 [02:26<206:50:22,  7.45s/it, ELBO=-1.78e+03]

  0%|                                                           | 21/100000 [02:34<207:30:09,  7.47s/it, ELBO=-1.4e+03]

  0%|                                                               | 22/100000 [02:42<210:15:34,  7.57s/it, ELBO=-533]

  0%|                                                          | 23/100000 [02:50<212:57:40,  7.67s/it, ELBO=-1.56e+03]

  0%|                                                          | 24/100000 [02:57<212:39:36,  7.66s/it, ELBO=-2.86e+03]

  0%|                                                          | 25/100000 [03:05<211:17:01,  7.61s/it, ELBO=-2.85e+03]

  0%|                                                          | 26/100000 [03:12<203:58:47,  7.35s/it, ELBO=-1.02e+03]

  0%|                                                          | 27/100000 [03:19<201:44:58,  7.26s/it, ELBO=-2.53e+04]

  0%|                                                               | 28/100000 [03:26<203:23:09,  7.32s/it, ELBO=-611]


  0%|                                                          | 30/100000 [03:40<198:57:04,  7.16s/it, ELBO=-1.03e+03]

  0%|                                                               | 31/100000 [03:47<192:03:09,  6.92s/it, ELBO=-827]

  0%|                                                               | 32/100000 [03:53<191:05:37,  6.88s/it, ELBO=-707]

  0%|                                                          | 33/100000 [04:00<191:46:17,  6.91s/it, ELBO=-1.52e+03]
-1523.7113037109375


  0%|                                                          | 35/100000 [04:13<185:34:17,  6.68s/it, ELBO=-3.18e+03]
-3183.9765625


  0%|                                                               | 37/100000 [04:27<186:40:45,  6.72s/it, ELBO=-692]
-691.6444702148438

  0%|                                                               | 38/100000 [04:33<186:50:49,  6.73s/it, ELBO=-699]

  0%|                                                               | 39/100000 [04:40<186:10:51,  6.71s/it, ELBO=-871]

  0%|                                                               | 40/100000 [04:47<185:42:28,  6.69s/it, ELBO=-449]

  0%|                                                           | 41/100000 [04:54<193:12:25,  6.96s/it, ELBO=-1.1e+04]

  0%|                                                               | 42/100000 [05:01<191:54:06,  6.91s/it, ELBO=-460]

  0%|                                                               | 43/100000 [05:08<191:19:39,  6.89s/it, ELBO=-376]

  0%|                                                          | 44/100000 [05:15<189:07:04,  6.81s/it, ELBO=-1.58e+03]Traceback (most recent call last):
  File "inference.py", line 372, in <module>
    samples = inference_algorithm(program, args.n_samples)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 161, in black_box_variational_inference
    r_tl, sigma_tl = evaluate_program(ast,sigma=sigma)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 36, in evaluate_program
    return EVAL(ast[0], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  [Previous line repeated 1 more time]
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 79, in EVAL
    c_1, sigma = EVAL(e[1][1], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 93, in EVAL
    c[i], sigma = EVAL(e[i], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 75, in EVAL
    sigma['log_W'] = sigma['log_W'] + d.log_prob(c).detach()
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/distributions.py", line 33, in log_prob
    return super().log_prob(x)
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/distributions/normal.py", line 77, in log_prob
    return -((value - self.loc) ** 2) / (2 * var) - log_scale - math.log(math.sqrt(2 * math.pi))
KeyboardInterrupt