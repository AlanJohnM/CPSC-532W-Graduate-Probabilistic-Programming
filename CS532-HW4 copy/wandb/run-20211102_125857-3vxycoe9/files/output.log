
-111579709440.0
  0%|                                                            | 1/100000 [00:01<29:31:03,  1.06s/it, ELBO=-1.12e+11]
-150847.625

  0%|                                                            | 3/100000 [00:02<28:03:44,  1.01s/it, ELBO=-1.88e+04]
-3505.7880859375
-71135.515625


  0%|                                                            | 8/100000 [00:07<23:37:55,  1.18it/s, ELBO=-6.15e+04]
-333841.1875

  0%|                                                           | 10/100000 [00:08<23:06:26,  1.20it/s, ELBO=-1.45e+08]
-135673.859375

  0%|                                                           | 13/100000 [00:11<23:32:22,  1.18it/s, ELBO=-4.53e+06]
-21197.197265625
-4011429.5

  0%|                                                           | 15/100000 [00:12<22:32:29,  1.23it/s, ELBO=-1.22e+04]
-9341.93359375

  0%|                                                            | 18/100000 [00:15<22:44:10,  1.22it/s, ELBO=-6.7e+05]
-21008.470703125
-10554.8173828125

  0%|                                                           | 20/100000 [00:17<23:18:10,  1.19it/s, ELBO=-5.66e+04]
-7034.75927734375

  0%|                                                           | 23/100000 [00:19<22:59:24,  1.21it/s, ELBO=-2.93e+07]
-15465.25390625
-380219.40625

  0%|                                                           | 25/100000 [00:21<23:08:21,  1.20it/s, ELBO=-6.02e+05]
-75547.046875

  0%|                                                           | 28/100000 [00:23<22:51:22,  1.21it/s, ELBO=-2.94e+03]
-42424.58984375
-61557.42578125

  0%|                                                           | 30/100000 [00:25<22:45:59,  1.22it/s, ELBO=-6.53e+04]
-11634.197265625

  0%|                                                           | 33/100000 [00:27<21:54:27,  1.27it/s, ELBO=-8.51e+03]
-2374901.25
-11353.3173828125
-8507.2353515625
-1687045.875

  0%|                                                           | 35/100000 [00:29<22:18:39,  1.24it/s, ELBO=-3.68e+06]
-23919.4375

  0%|                                                           | 37/100000 [00:30<23:21:29,  1.19it/s, ELBO=-8.19e+03]
-17060.041015625

  0%|                                                           | 39/100000 [00:33<27:01:35,  1.03it/s, ELBO=-3.46e+05]
-11245.37890625

  0%|                                                           | 41/100000 [00:35<29:12:34,  1.05s/it, ELBO=-1.25e+05]
-41325.4140625

  0%|                                                           | 43/100000 [00:37<27:44:19,  1.00it/s, ELBO=-2.19e+05]
-8945.2724609375

  0%|                                                           | 45/100000 [00:38<25:33:10,  1.09it/s, ELBO=-5.31e+04]
-10316.4384765625
-201387.015625

  0%|                                                           | 48/100000 [00:41<25:07:52,  1.10it/s, ELBO=-2.27e+05]
-14399.15234375

  0%|                                                           | 50/100000 [00:43<24:50:30,  1.12it/s, ELBO=-1.11e+05]
-107737.109375

  0%|                                                           | 52/100000 [00:45<24:50:14,  1.12it/s, ELBO=-1.48e+05]
-213506.015625

  0%|                                                              | 54/100000 [00:47<24:54:49,  1.11it/s, ELBO=-2e+04]
-15078.9189453125
-10739779.0

  0%|                                                           | 57/100000 [00:49<24:16:37,  1.14it/s, ELBO=-4.99e+03]
-5466628.0

  0%|                                                           | 59/100000 [00:51<24:13:51,  1.15it/s, ELBO=-1.09e+06]
-36112.65234375

  0%|                                                           | 61/100000 [00:53<24:32:46,  1.13it/s, ELBO=-2.85e+06]
-3503046.75

  0%|                                                           | 63/100000 [00:54<24:36:29,  1.13it/s, ELBO=-7.42e+04]
-7693.86767578125
-2872.477783203125

  0%|                                                           | 66/100000 [00:57<24:58:05,  1.11it/s, ELBO=-1.94e+04]
-210877.6875

  0%|                                                           | 68/100000 [00:59<24:41:48,  1.12it/s, ELBO=-3.61e+03]
-30878.544921875

  0%|                                                           | 70/100000 [01:01<24:33:57,  1.13it/s, ELBO=-3.44e+04]
-28438.1640625
-39102.80078125

  0%|                                                           | 73/100000 [01:03<24:17:43,  1.14it/s, ELBO=-5.18e+04]
-33185530.0

  0%|                                                           | 75/100000 [01:05<24:17:17,  1.14it/s, ELBO=-4.08e+05]
-7501.13818359375

  0%|                                                           | 77/100000 [01:07<25:29:26,  1.09it/s, ELBO=-2.71e+05]
-220000.453125

  0%|                                                            | 79/100000 [01:09<27:52:22,  1.00s/it, ELBO=-1.4e+05]
-26220.705078125

  0%|                                                            | 81/100000 [01:11<28:18:56,  1.02s/it, ELBO=-7.6e+05]
-79372.671875

  0%|                                                            | 83/100000 [01:13<26:22:04,  1.05it/s, ELBO=-1.6e+04]
-88695.2265625

  0%|                                                           | 85/100000 [01:15<26:17:25,  1.06it/s, ELBO=-1.95e+07]
-765368.9375

  0%|                                                           | 87/100000 [01:17<27:42:41,  1.00it/s, ELBO=-1.62e+04]
-355925.15625

  0%|                                                           | 89/100000 [01:19<25:45:04,  1.08it/s, ELBO=-2.38e+05]
-74889.984375
-1614283.375

  0%|                                                           | 92/100000 [01:21<23:54:35,  1.16it/s, ELBO=-7.11e+04]

  0%|                                                           | 93/100000 [01:22<26:03:31,  1.06it/s, ELBO=-1.03e+05]

  0%|                                                           | 94/100000 [01:24<33:46:57,  1.22s/it, ELBO=-2.66e+04]
-15856.2802734375
-6979.6748046875

  0%|                                                           | 97/100000 [01:27<27:55:32,  1.01s/it, ELBO=-2.14e+05]
-8685.4970703125

  0%|                                                           | 99/100000 [01:29<25:01:22,  1.11it/s, ELBO=-1.27e+05]
-54177.19921875
-10879.2802734375

  0%|                                                           | 102/100000 [01:31<23:43:50,  1.17it/s, ELBO=-1.3e+05]
-70619.8984375

  0%|                                                          | 104/100000 [01:33<25:16:19,  1.10it/s, ELBO=-3.34e+05]
-174916.28125

  0%|                                                          | 106/100000 [01:35<25:23:58,  1.09it/s, ELBO=-5.34e+04]
-5441.64892578125

  0%|                                                          | 108/100000 [01:37<24:40:59,  1.12it/s, ELBO=-2.22e+06]
-91690.6875
-16914.01953125

  0%|                                                          | 111/100000 [01:39<23:32:48,  1.18it/s, ELBO=-7.24e+03]
-75431.9453125

  0%|                                                          | 113/100000 [01:41<24:32:03,  1.13it/s, ELBO=-7.09e+04]
-418856.46875

  0%|                                                          | 115/100000 [01:43<25:23:55,  1.09it/s, ELBO=-1.42e+05]Traceback (most recent call last):
  File "inference.py", line 372, in <module>
    samples = inference_algorithm(program, args.n_samples)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 167, in black_box_variational_inference
    r_tl, sigma_tl = evaluate_program(ast,sigma=sigma)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 36, in evaluate_program
    return EVAL(ast[0], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 79, in EVAL
    c_1, sigma = EVAL(e[1][1], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 93, in EVAL
    c[i], sigma = EVAL(e[i], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 79, in EVAL
    c_1, sigma = EVAL(e[1][1], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 66, in EVAL
    q_log_prob.backward()
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/autograd/__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt