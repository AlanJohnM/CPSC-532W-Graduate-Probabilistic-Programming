

































  1%|‚ñç                                                          | 772/100000 [01:08<2:06:32, 13.07it/s, ELBO=-1.89e+03]Traceback (most recent call last):
  File "inference.py", line 372, in <module>
    samples = inference_algorithm(program, args.n_samples)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 158, in black_box_variational_inference
    r_tl, sigma_tl = evaluate_program(ast,sigma=sigma)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 36, in evaluate_program
    return EVAL(ast[0], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  [Previous line repeated 1 more time]
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 79, in EVAL
    c_1, sigma = EVAL(e[1][1], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 93, in EVAL
    c[i], sigma = EVAL(e[i], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 81, in EVAL
    return EVAL(e[2], sigma, l, rho)
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/black_box_variational_inference.py", line 75, in EVAL
    sigma['log_W'] = sigma['log_W'] + d.log_prob(c).detach()
  File "/Users/alansmacbook/Desktop/CPSC 532W/CPSC-532W-Graduate-Probabilistic-Programming/CS532-HW4/distributions.py", line 33, in log_prob
    return super().log_prob(x)
  File "/Users/alansmacbook/anaconda3/lib/python3.7/site-packages/torch/distributions/normal.py", line 77, in log_prob
    return -((value - self.loc) ** 2) / (2 * var) - log_scale - math.log(math.sqrt(2 * math.pi))
KeyboardInterrupt